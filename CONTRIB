# Contribution Guide

This document is a quick, contributor-friendly guide to how we build Narratoria.

Authoritative rules live in the project constitution:
- `.specify/memory/constitution.md`

If this file and the constitution ever disagree, the constitution wins.

## How we work

- Specs-first: behavior is defined in `specs/`. Code is an implementation detail.
- Drift is visible: if you discover a mismatch between spec and code, update the spec or log it in `TODO`.
- Keep changes focused: do not refactor unrelated code “while you’re there.”

## Design principles (summary)

- Small interfaces: prefer 1–3 member interfaces that represent one concern.
- Composition over inheritance: wire behavior with collaborators (fields/delegates).
- Prefer immutability: use immutable data structures by default; make mutation explicit.
- Pure core: keep logic deterministic; put IO/time/random behind small interfaces.
- Async discipline: always accept and honor `CancellationToken`; avoid fire-and-forget.
- Be explicit with errors: expected outcomes are results; exceptions are for exceptional failures, with added context.

## Testing expectations

- Tests must be deterministic (no real clocks/external IO; inject collaborators).
- Table-driven tests are preferred for units.
- UI component changes must include Playwright for .NET end-to-end coverage.

## What to do when something is unclear

- If requirements are ambiguous, update the relevant spec first.
- If you can’t finish work without placeholders, omit the incomplete implementation and record the gap in `TODO`.

## Need the technical version?

Use `.specify/memory/constitution.md` as the normative, more technical guide.
