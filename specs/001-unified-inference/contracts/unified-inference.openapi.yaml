openapi: 3.0.3
info:
  title: Unified Inference (HF-Only Library Contracts)
  version: 0.2.0
  description: HF-only unified inference surface (documented as HTTP for clarity). The real deliverable is a .NET class library wrapping the Hugging Face Inference API via tryAGI/HuggingFace.
paths:
  /inference/text:
    post:
      summary: Generate text
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TextRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TextResponse'
        '400':
          description: Not supported or invalid request
  /inference/image:
    post:
      summary: Generate image
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ImageRequest'
      responses:
        '200':
          description: OK (binary or URI)
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ImageResponse'
        '400':
          description: Not supported or invalid request
  /inference/audio/tts:
    post:
      summary: Text-to-speech
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AudioTtsRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AudioResponse'
        '400':
          description: Not supported or invalid request
  /inference/audio/stt:
    post:
      summary: Speech-to-text
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AudioSttRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AudioResponse'
        '400':
          description: Not supported or invalid request
  /inference/video:
    post:
      summary: Generate video (best-effort)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/VideoRequest'
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/VideoResponse'
        '400':
          description: Not supported or invalid request
  /capabilities:
    get:
      summary: Query capabilities for provider+model
      parameters:
        - in: query
          name: modelId
          schema:
            type: string
          required: true
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ModelCapabilities'
components:
  schemas:
    GenerationSettings:
      type: object
      properties:
        temperature:
          type: number
        top_p:
          type: number
        top_k:
          type: integer
        max_new_tokens:
          type: integer
        do_sample:
          type: boolean
        repetition_penalty:
          type: number
        return_full_text:
          type: boolean
        stop_sequences:
          type: array
          items:
            type: string
        seed:
          type: integer
        guidance_scale:
          type: number
        num_inference_steps:
          type: integer
        height:
          type: integer
        width:
          type: integer
        scheduler:
          type: string
        negative_prompt:
          type: string
        use_cache:
          type: boolean
        wait_for_model:
          type: boolean
        provider_overrides:
          type: object
    ModelCapabilities:
      type: object
      properties:
        supportsText:
          type: boolean
        supportsImage:
          type: boolean
        supportsAudioTts:
          type: boolean
        supportsAudioStt:
          type: boolean
        supportsVideo:
          type: boolean
        supportsMusic:
          type: boolean
        settingsSupport:
          type: object
        pipeline_tag:
          type: string
        gated:
          type: boolean
        inference_status:
          type: string
        notes:
          type: string
    TextRequest:
      type: object
      properties:
        modelId:
          type: string
        prompt:
          type: string
        settings:
          $ref: '#/components/schemas/GenerationSettings'
    TextResponse:
      type: object
      properties:
        text:
          type: string
        tokensUsed:
          type: integer
        providerMetadata:
          type: object
    ImageRequest:
      type: object
      properties:
        modelId:
          type: string
        prompt:
          type: string
        size:
          type: string
        settings:
          $ref: '#/components/schemas/GenerationSettings'
    ImageResponse:
      type: object
      properties:
        uri:
          type: string
        bytesBase64:
          type: string
        providerMetadata:
          type: object
    AudioTtsRequest:
      type: object
      properties:
        modelId:
          type: string
        text:
          type: string
        voice:
          type: string
        settings:
          $ref: '#/components/schemas/GenerationSettings'
    AudioSttRequest:
      type: object
      properties:
        modelId:
          type: string
        audioBase64:
          type: string
        language:
          type: string
        settings:
          $ref: '#/components/schemas/GenerationSettings'
    AudioResponse:
      type: object
      properties:
        audioBase64:
          type: string
        transcriptText:
          type: string
        providerMetadata:
          type: object
    VideoRequest:
      type: object
      properties:
        modelId:
          type: string
        prompt:
          type: string
        duration:
          type: integer
        settings:
          $ref: '#/components/schemas/GenerationSettings'
    VideoResponse:
      type: object
      properties:
        uri:
          type: string
        bytesBase64:
          type: string
        providerMetadata:
          type: object
