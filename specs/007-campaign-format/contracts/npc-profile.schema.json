{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://narratoria.dev/schemas/campaign/npc-profile.schema.json",
  "title": "NPC Profile",
  "description": "Structured definition of a non-player character for Narratoria campaigns",
  "type": "object",
  "required": ["name", "role", "personality"],
  "properties": {
    "name": {
      "type": "string",
      "minLength": 1,
      "maxLength": 100,
      "description": "NPC name",
      "examples": ["Merlin", "Croissant Claude", "The Silent Baker"]
    },
    "role": {
      "type": "string",
      "minLength": 1,
      "maxLength": 200,
      "description": "NPC role or archetype in the story",
      "examples": [
        "Protagonist - Court Wizard",
        "Antagonist - Sorceress",
        "Supporting - Friendly Shopkeeper",
        "Minor - Town Guard"
      ]
    },
    "age": {
      "type": "string",
      "description": "Age or age appearance (can be descriptive)",
      "examples": ["Unknown (appears elderly)", "Mid-20s", "Ancient", "Ageless"]
    },
    "personality": {
      "type": "object",
      "required": ["traits"],
      "properties": {
        "traits": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "minItems": 1,
          "maxItems": 10,
          "description": "Core personality traits",
          "examples": [["wise", "melancholic", "secretive", "compassionate"]]
        },
        "flaws": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "maxItems": 5,
          "description": "Character flaws or weaknesses",
          "examples": [["burdened by foresight", "reluctant to share truth"]]
        },
        "virtues": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "maxItems": 5,
          "description": "Character virtues or strengths",
          "examples": [["loyal", "patient", "protective"]]
        }
      },
      "description": "Personality profile including traits, flaws, and virtues"
    },
    "motivations": {
      "type": "array",
      "items": {
        "type": "string",
        "minLength": 5
      },
      "minItems": 1,
      "maxItems": 5,
      "description": "What drives this character (the 'why' behind their actions)",
      "examples": [[
        "Guide Arthur to unite the kingdoms",
        "Prevent the fall of Camelot (which he has foreseen)",
        "Atone for past mistakes with Morgana"
      ]]
    },
    "speech_patterns": {
      "type": "object",
      "properties": {
        "style": {
          "type": "string",
          "description": "How the character speaks (tone, formality, quirks)",
          "examples": [
            "Formal, archaic, uses metaphors from nature",
            "Casual, peppered with bread puns",
            "Terse, military precision"
          ]
        },
        "examples": {
          "type": "array",
          "items": {
            "type": "string",
            "minLength": 5
          },
          "minItems": 2,
          "maxItems": 10,
          "description": "Example dialogue lines showing speech patterns",
          "examples": [[
            "The river of time flows only one direction, young king.",
            "Even the mightiest oak was once a fragile acorn."
          ]]
        },
        "catchphrases": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "maxItems": 5,
          "description": "Optional catchphrases or repeated expressions"
        }
      },
      "description": "How the character speaks and example dialogue"
    },
    "relationships": {
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "description": "Relationship description"
      },
      "description": "Relationships with other characters (key = character name, value = relationship)",
      "examples": [{
        "arthur": "Mentor and protector, loves like a son",
        "morgana": "Former student, now enemy - feels guilt and sorrow"
      }]
    },
    "secrets": {
      "oneOf": [
        {
          "type": "string",
          "description": "Inline secret information"
        },
        {
          "type": "string",
          "pattern": "^[^/].*\\.md$",
          "description": "Path to secrets file (e.g., 'secrets.md')"
        }
      ],
      "description": "Hidden information not immediately revealed to player"
    },
    "appearance": {
      "type": "string",
      "description": "Physical description of the character",
      "examples": [
        "Tall elderly man with long white beard, piercing blue eyes, often wears flowing blue robes"
      ]
    },
    "portrait": {
      "type": "string",
      "pattern": "^art/",
      "description": "Path to character portrait image (relative to campaign root)",
      "examples": ["art/characters/merlin.png"]
    },
    "voice": {
      "type": "string",
      "pattern": "^music/",
      "description": "Optional path to character voice audio (relative to campaign root)",
      "examples": ["music/voices/merlin_greeting.mp3"]
    },
    "background": {
      "type": "string",
      "description": "Character backstory or history",
      "examples": [
        "Once a student of the druids, now serves as court wizard to protect Arthur's destiny"
      ]
    },
    "goals": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["description"],
        "properties": {
          "description": {
            "type": "string",
            "description": "Goal description"
          },
          "priority": {
            "type": "string",
            "enum": ["primary", "secondary", "tertiary"],
            "description": "Goal priority"
          },
          "status": {
            "type": "string",
            "enum": ["active", "completed", "failed", "blocked"],
            "description": "Goal status"
          }
        }
      },
      "description": "Specific goals the character is pursuing"
    },
    "stats": {
      "type": "object",
      "description": "Optional game statistics (system-dependent)",
      "examples": [{
        "strength": 8,
        "intelligence": 18,
        "wisdom": 20,
        "charisma": 14
      }]
    },
    "inventory": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "Items the character possesses",
      "examples": [["Staff of Power", "Ancient Spellbook", "Crystal Orb"]]
    },
    "metadata": {
      "type": "object",
      "properties": {
        "importance": {
          "type": "string",
          "enum": ["protagonist", "major", "supporting", "minor"],
          "description": "Story importance tier"
        },
        "first_appearance": {
          "type": "string",
          "description": "When/where the character first appears",
          "examples": ["Scene 1: Throne Room of Camelot"]
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Searchable tags for this character",
          "examples": [["wizard", "mentor", "prophet"]]
        }
      }
    }
  },
  "additionalProperties": false
}
